<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pilares de Progreso</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f8f8f8;}
    .header { padding: 20px; font-size: 24px; font-weight: bold; color: #333;}
    .charts-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 20px;}
    .chart-card { background: #fff; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 15px; text-align:center;}
    .chart-title { font-weight: bold; margin-bottom: 10px; cursor:pointer;}
    .chart-title.mental { color: #007bff;}
    canvas { max-width: 200px; max-height:200px;}
    .navbar { display: flex; justify-content: space-around; align-items:center; background:#fff; padding:10px 0; border-top:1px solid #eee; position:sticky; bottom:0;}
    .nav-item { flex:1; text-align:center; font-size:12px; color:#ccc;}
    .nav-item.active { color:#007bff;}
    /* ---- NUEVO: pantallas ---- */
    .screen { display:none; padding:20px;}
    .active-screen { display:block;}
    .btn { background:#007bff; color:#fff; border:none; padding:10px 15px; border-radius:5px; cursor:pointer; margin-top:10px;}
    .input { padding:8px; border:1px solid #ccc; border-radius:5px; margin:5px 0; width:100%;}
    .bar-chart-container { max-width:500px; margin:20px auto;}
  </style>
</head>
<body>

<div class="header">PILARES</div>

<!-- Pantalla principal -->
<div id="screen-main" class="screen active-screen">
  <div class="charts-container">
    <div class="chart-card">
      <a class="chart-title mental" onclick="openSleep()">SALUD MENTAL</a>
      <canvas id="chartMental"></canvas>
    </div>
    <div class="chart-card">
      <a class="chart-title physical">SALUD F√çSICA</a>
      <canvas id="chartPhysical"></canvas>
    </div>
  </div>
</div>

<!-- Pantalla de meta de sue√±o -->
<div id="screen-sleep-goal" class="screen">
  <h2>¬øCu√°l es tu meta de sue√±o?</h2>
  <input id="metaSueno" type="number" class="input" placeholder="Ej: 8 horas">
  <button class="btn" onclick="showHelper()">¬øNo sabes cu√°nto deber√≠a? Te ayudamos</button>
  <div id="helper" style="display:none;">
    <p>Ingresa tus datos:</p>
    <input id="edad" type="number" class="input" placeholder="Edad">
    <select id="sexo" class="input">
      <option value="f">Femenino</option>
      <option value="m">Masculino</option>
    </select>
    <button class="btn" onclick="calcularRecomendacion()">Calcular</button>
    <p id="recomendacion"></p>
  </div>
  <button class="btn" onclick="goToTracking()">Finalizar</button>
</div>

<!-- Pantalla de seguimiento de sue√±o -->
<div id="screen-sleep-tracking" class="screen">
  <h2>Seguimiento de Dormir</h2>
  <div class="bar-chart-container">
    <canvas id="sleepChart"></canvas>
  </div>
  <label>Desde:</label>
  <input id="desde" type="time" class="input">
  <label>Hasta:</label>
  <input id="hasta" type="time" class="input">
  <button class="btn" onclick="addSleepData()">‚û§ Agregar</button>
  <br><br>
  <button class="btn" onclick="backToMain()">Volver a Pilares</button>
</div>

<!-- Men√∫ inferior -->
<div class="navbar">
  <div class="nav-item active">üìà</div>
  <div class="nav-item">üóìÔ∏è</div>
  <div class="nav-item">üë§</div>
</div>

<script>
  let sleepChart;

  function openSleep(){
    showScreen("screen-sleep-goal");
  }

  function showHelper(){
    document.getElementById("helper").style.display="block";
  }

  function calcularRecomendacion(){
    let edad = parseInt(document.getElementById("edad").value);
    let sexo = document.getElementById("sexo").value;
    let rec;
    if(edad>=18 && edad<=25){
      rec = "Lo recomendable son 7 a 9 horas. Para ti, objetivo √≥ptimo: 8 h.";
    } else {
      rec = "Generalmente se recomiendan 7-9 h para adultos.";
    }
    document.getElementById("recomendacion").innerText = rec;
    document.getElementById("metaSueno").value = 8;
  }

  function goToTracking(){
    showScreen("screen-sleep-tracking");
    // inicializar gr√°fico de barras
    const ctx = document.getElementById("sleepChart").getContext("2d");
    sleepChart = new Chart(ctx,{
      type:"bar",
      data:{
        labels:["Hoy"],
        datasets:[{
          label:"Horas de sue√±o",
          data:[0],
          backgroundColor:"rgba(0,123,255,0.3)"
        }]
      },
      options:{
        scales:{ y:{ beginAtZero:true, max:12 } }
      }
    });
  }

  function addSleepData(){
    const desde = document.getElementById("desde").value;
    const hasta = document.getElementById("hasta").value;
    if(desde && hasta){
      let h1 = new Date("2000-01-01T"+desde+":00");
      let h2 = new Date("2000-01-01T"+hasta+":00");
      if(h2<=h1) h2.setDate(h2.getDate()+1); // cruzar medianoche
      let horas = (h2-h1)/(1000*60*60);

      sleepChart.data.datasets[0].data[0] = horas;
      sleepChart.update();
    }
  }

  function backToMain(){
    showScreen("screen-main");
  }

  function showScreen(id){
    document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active-screen"));
    document.getElementById(id).classList.add("active-screen");
  }
</script>
</body>
</html>
